# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
print(superdane[[4]][["Ocaleni"]][is.na(superdane[[4]][["Ofiary"]]) & !is.na(superdane[[4]][["Ocaleni"]])])
}
for (n in 1:N){
# zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
# ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = T))
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
print(superdane[[4]][["Ocaleni"]][!is.na(superdane[[4]][["Ofiary"]]) & is.na(superdane[[4]][["Ocaleni"]])])
}
for (n in 1:N){
# zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
# ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = T))
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
print(superdane[[4]][["Ocaleni"]][is.na(superdane[[4]][["Ofiary"]]) & is.na(superdane[[4]][["Ocaleni"]])])
}
for (n in 1:N){
# zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
# ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = T))
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
print(superdane[[4]][["Ocaleni"]][!is.na(superdane[[4]][["Ofiary"]]) & !is.na(superdane[[4]][["Ocaleni"]])])
}
for (n in 1:N){
# zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
# ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = T))
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
print(superdane[[n]][["Ocaleni"]][is.na(superdane[[n]][["Ofiary"]]) & !is.na(superdane[[n]][["Ocaleni"]])])
}
for (n in 1:N){
# zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
# ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = T))
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
print(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
for (n in 1:N){
# zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
# ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = T))
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
suma_zgonow<-0
suma_ocalen<-0
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = F))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = F))
suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
#print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
zgony_w_latach
suma_zgonow<-0
suma_ocalen<-0
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = F))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = F))
suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
#print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
suma_zgonow
suma_ocalen
suma_zgonow<-0
suma_ocalen<-0
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = F))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = F))
suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = F)
suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = F)
#print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
suma_zgonow
suma_ocalen<-0
suma_zgonow<-0
suma_ocalen<-0
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = F))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = F))
suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = F)
suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = F)
#print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
suma_zgonow
suma_ocalen
zgony_w_latach
zgony_w_latach[is.na(ocalania_w_latach)]
zgony_w_latach[!is.na(ocalania_w_latach)]
zgony_w_latach[is.na(ocalenia_w_latach)]
zgony_w_latach[!is.na(ocalenia_w_latach)]
superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])])
superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]
library(rvest)
library(stringr)
url<-"https://pl.wikipedia.org/wiki/Katastrofy_i_incydenty_cywilnych_samolot%C3%B3w_pasa%C5%BCerskich?fbclid=IwAR2tXXC4Z4bFOv6Ml1uVeepVWg2S7EEd53hQ2D3WLABtRH8WFLYf5MIppX8"
x<-url
parse_result<-function(x){
read_html(x)%>%
html_nodes("table")%>%
html_table()->tabele
}
em<-parse_result(url)
N <- 89 # lata 1930 - 2018
J <- 9
new_em <- em[6:94] #wywalam spis tresci i lata z dziurami
for (n in 1:N) { #"czyszcze danych, ujednolicam format"
#new_em[[n]][["Data"]] <-substr(new_em[[n]][["Data"]],1,10)
#if(new_em[[n]][["Data"]]<1) #jesli jest format z 0000
#new_em[[n]][["Data"]] <-gsub("0000", n+1929, new_em[[n]][["Data"]])
new_em[[n]][["Data"]][new_em[[n]][["Data"]]<1] <-str_sub(new_em[[n]][["Data"]][new_em[[n]][["Data"]]<1],start=11)
dzien <-substr(new_em[[n]][["Data"]],1,2)
new_em[[n]][["Data"]]<-replace(new_em[[n]][["Data"]],grep("stycznia", new_em[[n]][["Data"]]),paste(toString(n+1929),"01",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("lutego", new_em[[n]][["Data"]]),paste(toString(n+1929),"02",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("marca", new_em[[n]][["Data"]]),paste(toString(n+1929),"03",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("kwietnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"04",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("maja", new_em[[n]][["Data"]]),paste(toString(n+1929),"05",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("czerwca", new_em[[n]][["Data"]]),paste(toString(n+1929),"06",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("lipca", new_em[[n]][["Data"]]),paste(toString(n+1929),"07",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("sierpnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"08",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("wrze", new_em[[n]][["Data"]]),paste(toString(n+1929),"09",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("listopada", new_em[[n]][["Data"]]),paste(toString(n+1929),"11",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("grudnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"12",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("pa", new_em[[n]][["Data"]]),paste(toString(n+1929),"10",sep="-"))
dzien <-gsub(" ","",dzien)
dzien[strtoi(dzien)<10] <- paste0("0",dzien[strtoi(dzien)<10])
new_em[[n]][["Data"]]<-paste(new_em[[n]][["Data"]],dzien,sep="-")
# pewnie da się to zrobić krócej ale już spedziłem na tym chyba z 5h przez to że format daty z wikipedii raz był "0000-02-1111 lutego" a raz "14 lipca" itp
# a do tego wszystkiego grep nie obsługuje 'ś' i 'ź' więc był problem z październikiem i wrześniem ale chyba jest ok narazie XD
for(j in 1:J)
{
new_em[[n]][[j]][new_em[[n]][[j]]=='?'] <- NA
}
#zamieniam '?' na <NA>
}
new_em[[89]][["Data"]]
superdane <- new_em
lapply(superdane, function(x) write.table( data.frame(x), 'superdane.csv'  , append= T, sep=',' ))
View(superdane) # lista 89 elementów (jeden element == lista z danego roku)
suma_zgonow<-0
suma_ocalen<-0
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = F))
#
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
# #print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
#w 4 przypadkach są ofiary a ocaleni są NA
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = F))
#
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
# #print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
superdane <- new_em
library(rvest)
library(stringr)
url<-"https://pl.wikipedia.org/wiki/Katastrofy_i_incydenty_cywilnych_samolot%C3%B3w_pasa%C5%BCerskich?fbclid=IwAR2tXXC4Z4bFOv6Ml1uVeepVWg2S7EEd53hQ2D3WLABtRH8WFLYf5MIppX8"
x<-url
parse_result<-function(x){
read_html(x)%>%
html_nodes("table")%>%
html_table()->tabele
}
em<-parse_result(url)
N <- 89 # lata 1930 - 2018
J <- 9
new_em <- em[6:94] #wywalam spis tresci i lata z dziurami
for (n in 1:N) { #"czyszcze danych, ujednolicam format"
#new_em[[n]][["Data"]] <-substr(new_em[[n]][["Data"]],1,10)
#if(new_em[[n]][["Data"]]<1) #jesli jest format z 0000
#new_em[[n]][["Data"]] <-gsub("0000", n+1929, new_em[[n]][["Data"]])
new_em[[n]][["Data"]][new_em[[n]][["Data"]]<1] <-str_sub(new_em[[n]][["Data"]][new_em[[n]][["Data"]]<1],start=11)
dzien <-substr(new_em[[n]][["Data"]],1,2)
new_em[[n]][["Data"]]<-replace(new_em[[n]][["Data"]],grep("stycznia", new_em[[n]][["Data"]]),paste(toString(n+1929),"01",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("lutego", new_em[[n]][["Data"]]),paste(toString(n+1929),"02",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("marca", new_em[[n]][["Data"]]),paste(toString(n+1929),"03",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("kwietnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"04",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("maja", new_em[[n]][["Data"]]),paste(toString(n+1929),"05",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("czerwca", new_em[[n]][["Data"]]),paste(toString(n+1929),"06",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("lipca", new_em[[n]][["Data"]]),paste(toString(n+1929),"07",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("sierpnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"08",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("wrze", new_em[[n]][["Data"]]),paste(toString(n+1929),"09",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("listopada", new_em[[n]][["Data"]]),paste(toString(n+1929),"11",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("grudnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"12",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("pa", new_em[[n]][["Data"]]),paste(toString(n+1929),"10",sep="-"))
dzien <-gsub(" ","",dzien)
dzien[strtoi(dzien)<10] <- paste0("0",dzien[strtoi(dzien)<10])
new_em[[n]][["Data"]]<-paste(new_em[[n]][["Data"]],dzien,sep="-")
# pewnie da się to zrobić krócej ale już spedziłem na tym chyba z 5h przez to że format daty z wikipedii raz był "0000-02-1111 lutego" a raz "14 lipca" itp
# a do tego wszystkiego grep nie obsługuje 'ś' i 'ź' więc był problem z październikiem i wrześniem ale chyba jest ok narazie XD
for(j in 1:J)
{
new_em[[n]][[j]][new_em[[n]][[j]]=='?'] <- NA
}
#zamieniam '?' na <NA>
}
new_em[[89]][["Data"]]
superdane <- new_em
lapply(superdane, function(x) write.table( data.frame(x), 'superdane.csv'  , append= T, sep=',' ))
View(superdane) # lista 89 elementów (jeden element == lista z danego roku)
suma_zgonow<-0
suma_ocalen<-0
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = F))
#
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
# #print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
#w 4 przypadkach są ofiary a ocaleni są NA
library(rvest)
library(stringr)
url<-"https://pl.wikipedia.org/wiki/Katastrofy_i_incydenty_cywilnych_samolot%C3%B3w_pasa%C5%BCerskich?fbclid=IwAR2tXXC4Z4bFOv6Ml1uVeepVWg2S7EEd53hQ2D3WLABtRH8WFLYf5MIppX8"
x<-url
parse_result<-function(x){
read_html(x)%>%
html_nodes("table")%>%
html_table()->tabele
}
em<-parse_result(url)
N <- 89 # lata 1930 - 2018
J <- 9
new_em <- em[6:94] #wywalam spis tresci i lata z dziurami
for (n in 1:N) { #"czyszcze danych, ujednolicam format"
#new_em[[n]][["Data"]] <-substr(new_em[[n]][["Data"]],1,10)
#if(new_em[[n]][["Data"]]<1) #jesli jest format z 0000
#new_em[[n]][["Data"]] <-gsub("0000", n+1929, new_em[[n]][["Data"]])
new_em[[n]][["Data"]][new_em[[n]][["Data"]]<1] <-str_sub(new_em[[n]][["Data"]][new_em[[n]][["Data"]]<1],start=11)
dzien <-substr(new_em[[n]][["Data"]],1,2)
new_em[[n]][["Data"]]<-replace(new_em[[n]][["Data"]],grep("stycznia", new_em[[n]][["Data"]]),paste(toString(n+1929),"01",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("lutego", new_em[[n]][["Data"]]),paste(toString(n+1929),"02",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("marca", new_em[[n]][["Data"]]),paste(toString(n+1929),"03",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("kwietnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"04",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("maja", new_em[[n]][["Data"]]),paste(toString(n+1929),"05",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("czerwca", new_em[[n]][["Data"]]),paste(toString(n+1929),"06",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("lipca", new_em[[n]][["Data"]]),paste(toString(n+1929),"07",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("sierpnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"08",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("wrze", new_em[[n]][["Data"]]),paste(toString(n+1929),"09",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("listopada", new_em[[n]][["Data"]]),paste(toString(n+1929),"11",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("grudnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"12",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("pa", new_em[[n]][["Data"]]),paste(toString(n+1929),"10",sep="-"))
dzien <-gsub(" ","",dzien)
dzien[strtoi(dzien)<10] <- paste0("0",dzien[strtoi(dzien)<10])
new_em[[n]][["Data"]]<-paste(new_em[[n]][["Data"]],dzien,sep="-")
# pewnie da się to zrobić krócej ale już spedziłem na tym chyba z 5h przez to że format daty z wikipedii raz był "0000-02-1111 lutego" a raz "14 lipca" itp
# a do tego wszystkiego grep nie obsługuje 'ś' i 'ź' więc był problem z październikiem i wrześniem ale chyba jest ok narazie XD
for(j in 1:J)
{
new_em[[n]][[j]][new_em[[n]][[j]]=='?'] <- NA
}
#zamieniam '?' na <NA>
}
new_em[[89]][["Data"]]
superdane <- new_em
lapply(superdane, function(x) write.table( data.frame(x), 'superdane.csv'  , append= T, sep=',' ))
View(superdane) # lista 89 elementów (jeden element == lista z danego roku)
suma_zgonow<-0
suma_ocalen<-0
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = F))
#
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
# #print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
#w 4 przypadkach są ofiary a ocaleni są NA
zgony_w_latach
length(zgony_w_latach)
length(ocalenia_w_latach)
suma_zgonow<-0
suma_ocalen<-0
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = T))
#
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
# #print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
length(zgony_w_latach)
length(ocalenia_w_latach)
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]]),na.rm = T))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = T))
#
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
# #print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
length(ocalenia_w_latach)
length(zgony_w_latach)
zgony_w_latach
ocalenia_w_latach
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
zgony_w_latach/ocalenia_w_latach
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
zgony_w_latach/(ocalenia_w_latach+zgony w latach)
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
zgony_w_latach/(ocalenia_w_latach+zgony_w_latach)
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
zgony_w_latach
ocalenia_w_latach
ocalenia_w_latach/(ocalenia_w_latach+zgony_w_latach)
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
procent_ocalalalych_w_latach <-ocalenia_w_latach/(ocalenia_w_latach+zgony_w_latach)
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
round(procent_ocalalalych_w_latach <-ocalenia_w_latach/(ocalenia_w_latach+zgony_w_latach),2)
ocalenia_w_latach
zgony_w_latach
ocalenia_w_latach
ocalenia_w_latach+zgony_w_latach
ocalenia_w_latach+zgony_w_latach
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
round(procent_ocalalalych_w_latach <-ocalenia_w_latach/(ocalenia_w_latach+zgony_w_latach),2)
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
procent_ocalalalych_w_latach <-round(ocalenia_w_latach/(ocalenia_w_latach+zgony_w_latach),2)
#w 4 przypadkach są ofiary a ocaleni są NA
plot(procent)
#w 4 przypadkach są ofiary a ocaleni są NA
plot(procent_ocalalalych_w_latach)
?histogram
?boxplot
#w 4 przypadkach są ofiary a ocaleni są NA
hist(procent_ocalalalych_w_latach)
#w 4 przypadkach są ofiary a ocaleni są NA
hist(procent_ocalalalych_w_latach,freq=1)
#w 4 przypadkach są ofiary a ocaleni są NA
hist(procent_ocalalalych_w_latach,freq=.1)
#w 4 przypadkach są ofiary a ocaleni są NA
ggplot(procent_ocalalalych_w_latach,freq=.1)
install.packages("ggplot2")
#w 4 przypadkach są ofiary a ocaleni są NA
ggplot(procent_ocalalalych_w_latach,freq=.1)
?ggplot
?ggplot2
?ggplot2
library(ggplot2)
?ggplot
#w 4 przypadkach są ofiary a ocaleni są NA
ggplot(procent_ocalalalych_w_latach,freq=.1)
#w 4 przypadkach są ofiary a ocaleni są NA
qplot(as.factor(procent_ocalalalych_w_latach), geom="histogram")
#w 4 przypadkach są ofiary a ocaleni są NA
qplot(as.factor(procent_ocalalalych_w_latach), geom="histogram",stat="count")
#w 4 przypadkach są ofiary a ocaleni są NA
hist(procent_ocalalalych_w_latach)
ggplot(procent_ocalalalych_w_latach)
data.frame(procent_ocalalalych_w_latach,1:89)
data.frame(procent_ocalalalych_w_latach,1930:2018)
aaa<-data.frame(procent_ocalalalych_w_latach,1930:2018)
ggplot(aaa)
ggplot(aaa, aes(procent_ocalalalych_w_latach,X1930.2018))
ggplot(aaa, aes(procent_ocalalalych_w_latach,X1930.2018))+ geom_line() +
scale_x_date(format = "%b-%Y") + xlab("") + ylab("Daily Views")
ggplot(aaa, aes(procent_ocalalalych_w_latach,X1930.20118))
ggplot(aaa, aes(procent_ocalalalych_w_latach,X1930.2018))
ggplot(aaa, aes(X1930.2018,procent_ocalalalych_w_latach))
ggplot(aaa, aes(X1930.2018,procent_ocalalalych_w_latach))+geom_line()
aaa<-data.frame(procent_ocalalalych_w_latach,lata=1930:2018)
ggplot(aaa, aes(X1930.2018,procent_ocalalalych_w_latach))+geom_line()
ggplot(aaa, aes(lata,procent_ocalalalych_w_latach))+geom_line()
ggplot(aaa, aes(lata,procent_ocalalalych_w_latach))+ geom_histogram()
ggplot(aaa, aes(procent_ocalalalych_w_latach))+ geom_histogram()
ggplot(aaa, aes(procent_ocalalalych_w_latach))+ geom_histogram()+geom_histogram(binwidth=1)
ggplot(aaa, aes(procent_ocalalalych_w_latach))+ geom_histogram()+geom_histogram(binwidth=.1)
ggplot(aaa, aes(procent_ocalalalych_w_latach))+ geom_histogram()+geom_histogram(binwidth=.01)
ggplot(aaa, aes(procent_ocalalalych_w_latach))+ geom_histogram(color="lightblue")+geom_histogram(binwidth=.01)
ggplot(aaa, aes(procent_ocalalalych_w_latach))+ geom_histogram(color="lightblue",fill='white')+geom_histogram(binwidth=.01)
ggplot(aaa, aes(procent_ocalalalych_w_latach))+ geom_histogram(color="black",fill='white')+geom_histogram(binwidth=.01)
ggplot(aaa, aes(procent_ocalalalych_w_latach))+ geom_histogram(color="black")+geom_histogram(binwidth=.01)
procent_ocalalalych_w_latach
lata
aaa<-data.frame(procent_ocalalalych_w_latach,lata<-c(1930:2018))
#w 4 przypadkach są ofiary a ocaleni są NA
#hist(procent_ocalalalych_w_latach)
aaa<-data.frame(procent_ocalalalych_w_latach,lata<-c(1930:2018))
ggplot(aaa, aes(procent_ocalalalych_w_latach))+ geom_histogram(color="black")+geom_histogram(binwidth=.01)
ggplot(aaa, aes(lata))+ geom_histogram(color="black")+geom_histogram(binwidth=.01)
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
procent_ocalalalych_w_latach <-round(ocalenia_w_latach/(ocalenia_w_latach+zgony_w_latach),2)
procent_ocalalalych_w_latach
#w 4 przypadkach są ofiary a ocaleni są NA
#hist(procent_ocalalalych_w_latach)
lata<-c(1930:2018)
aaa<-data.frame(procent_ocalalalych_w_latach,lata)
ggplot(aaa, aes(lata))+ geom_histogram(color="black")+geom_histogram(binwidth=.01)
llata
lata
ggplot(aaa, aes(x=lata))+ geom_histogram(color="black")+geom_histogram(binwidth=.01)
ggplot(aaa, aes(x=lata))+ geom_histogram(color="black", binwidth = 30)
ggplot(aaa, aes(x=lata))+ geom_histogram(color="black", binwidth = 1)
ggplot(aaa, aes(x=lata))+ geom_histogram(color="black", binwidth = 30)
ggplot(aaa, aes(x=lata))+ geom_histogram(color="black", binwidth = 1)
aaa<-data.frame(lata,procent_ocalalalych_w_latach)
ggplot(aaa, aes(x=lata))+ geom_histogram(color="black", binwidth = 1)
aaa
aaa$procent_ocalalalych_w_latach
aaa[[1]]
aaa[[2]]
aaa[[0]]
aaa
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach)) + geom_point()
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity")
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=0.5)
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=1)
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=2)
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=2,color="blue")
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=2,color="blue",fill="white")
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=2,color="blue",fill="white")+theme_minimal()
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=1,color="blue",fill="white")+theme_minimal()
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=1,color="lightblue",fill="white")+theme_minimal()
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=1,color="blue",fill="lightblue")+theme_minimal()
+geom_text(aes(label=len), vjust=-0.3, size=3.5)
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=1,color="blue",fill="lightblue")+theme_minimal()+geom_text(aes(label=len), vjust=-0.3, size=3.5)
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=1,color="blue",fill="lightblue")+theme_minimal()+geom_text(aes(label=procent_ocalalalych_w_latach), vjust=-0.3, size=3.5)
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=1,color="blue",fill="lightblue")+theme_minimal()
library(rvest)
library(stringr)
library(ggplot2)
url<-"https://pl.wikipedia.org/wiki/Katastrofy_i_incydenty_cywilnych_samolot%C3%B3w_pasa%C5%BCerskich?fbclid=IwAR2tXXC4Z4bFOv6Ml1uVeepVWg2S7EEd53hQ2D3WLABtRH8WFLYf5MIppX8"
x<-url
parse_result<-function(x){
read_html(x)%>%
html_nodes("table")%>%
html_table()->tabele
}
em<-parse_result(url)
N <- 89 # lata 1930 - 2018
J <- 9
new_em <- em[6:94] #wywalam spis tresci i lata z dziurami
for (n in 1:N) { #"czyszcze danych, ujednolicam format"
#new_em[[n]][["Data"]] <-substr(new_em[[n]][["Data"]],1,10)
#if(new_em[[n]][["Data"]]<1) #jesli jest format z 0000
#new_em[[n]][["Data"]] <-gsub("0000", n+1929, new_em[[n]][["Data"]])
new_em[[n]][["Data"]][new_em[[n]][["Data"]]<1] <-str_sub(new_em[[n]][["Data"]][new_em[[n]][["Data"]]<1],start=11)
dzien <-substr(new_em[[n]][["Data"]],1,2)
new_em[[n]][["Data"]]<-replace(new_em[[n]][["Data"]],grep("stycznia", new_em[[n]][["Data"]]),paste(toString(n+1929),"01",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("lutego", new_em[[n]][["Data"]]),paste(toString(n+1929),"02",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("marca", new_em[[n]][["Data"]]),paste(toString(n+1929),"03",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("kwietnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"04",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("maja", new_em[[n]][["Data"]]),paste(toString(n+1929),"05",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("czerwca", new_em[[n]][["Data"]]),paste(toString(n+1929),"06",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("lipca", new_em[[n]][["Data"]]),paste(toString(n+1929),"07",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("sierpnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"08",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("wrze", new_em[[n]][["Data"]]),paste(toString(n+1929),"09",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("listopada", new_em[[n]][["Data"]]),paste(toString(n+1929),"11",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("grudnia", new_em[[n]][["Data"]]),paste(toString(n+1929),"12",sep="-"))
new_em[[n]][["Data"]] <-replace(new_em[[n]][["Data"]],grep("pa", new_em[[n]][["Data"]]),paste(toString(n+1929),"10",sep="-"))
dzien <-gsub(" ","",dzien)
dzien[strtoi(dzien)<10] <- paste0("0",dzien[strtoi(dzien)<10])
new_em[[n]][["Data"]]<-paste(new_em[[n]][["Data"]],dzien,sep="-")
# pewnie da się to zrobić krócej ale już spedziłem na tym chyba z 5h przez to że format daty z wikipedii raz był "0000-02-1111 lutego" a raz "14 lipca" itp
# a do tego wszystkiego grep nie obsługuje 'ś' i 'ź' więc był problem z październikiem i wrześniem ale chyba jest ok narazie XD
for(j in 1:J)
{
new_em[[n]][[j]][new_em[[n]][[j]]=='?'] <- NA
}
#zamieniam '?' na <NA>
}
new_em[[89]][["Data"]]
superdane <- new_em
lapply(superdane, function(x) write.table( data.frame(x), 'superdane.csv'  , append= T, sep=',' ))
View(superdane) # lista 89 elementów (jeden element == lista z danego roku)
suma_zgonow<-0
suma_ocalen<-0
zgony_w_latach<-c()
ocalenia_w_latach<-c()
for (n in 1:N){
zgony_w_latach<-append(zgony_w_latach,sum(strtoi(superdane[[n]][["Ofiary"]]),na.rm = T))
ocalenia_w_latach<-append(ocalenia_w_latach,sum(strtoi(superdane[[n]][["Ocaleni"]]),na.rm = T))
#
# suma_zgonow<-suma_zgonow+sum(strtoi(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ocaleni"]])]),na.rm = T)
# suma_ocalen<-suma_ocalen+sum(strtoi(superdane[[n]][["Ocaleni"]][!is.na(superdane[[n]][["Ofiary"]])]),na.rm = T)
# #print(superdane[[n]][["Ofiary"]][!is.na(superdane[[n]][["Ofiary"]]) & is.na(superdane[[n]][["Ocaleni"]])])
}
#print(suma_ocalen/(suma_zgonow+suma_ocalen)) #47% szansy na ocalanie?
procent_ocalalalych_w_latach <-round(ocalenia_w_latach/(ocalenia_w_latach+zgony_w_latach),2)
#w 4 przypadkach są ofiary a ocaleni są NA
lata<-c(1930:2018)
aaa<-data.frame(lata,procent_ocalalalych_w_latach)
ggplot(aaa, aes(x=lata, y=procent_ocalalalych_w_latach))+geom_bar(stat="identity", width=1,color="blue",fill="lightblue")+theme_minimal()
